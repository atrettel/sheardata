% Copyright (C) 2020-2022 Andrew Trettel
%
% SPDX-License-Identifier: CC-BY-4.0
\chapter{Design of the database}


\section{Project goals}

The primary goal of this project is to create a single SQLite database that
contains data from as many different shear layer experiments and simulations as
possible.  The data should include uncertainties where possible, and the
project should also concentrate on ensuring that the data remain accessible and
understandable in the long term.  The secondary goal is to create a report
documenting the database and the data itself.  This report serves as a data and
literature review for many different flow classes (a meta-analysis of sorts).

Using this database, it should be possible to ask many different questions
about various kinds of flows directly, without requiring additional
experimentation or simulation.  It also should reveal gaps in current
knowledge, to inform new directions for research.  Lastly, the database would
be valuable for the validation of new theories and numerical codes.


\section{Design goals}

\begin{itemize}

\item The database MUST use SQLite as the database backend.  The primary goal
here is to ensure that it is possible to use SQL commands to select and find
data.  The secondary goal is to emphasize achival quality and long-term access
to the data.  SQLite acts as an open standard that should be supported for
decades.

\item The database MUST include some form of uncertainty quantification (at
least standard uncertainties).

\item The database MUST store the data as generic records, with each data point
in a flow merely being a record in a particular table depending on the category
of the data.  This choice contrasts with a more typical ``spreadsheet''-style
design, which creates new columns for each relevant quantity or averaging
system.  This choice offers much more flexiblity, since it allows for
scalability, since the database can then support the addition of many different
quantities and averaging systems without having to change the database schema.

\item Similarly, the database SHOULD data over structure, since data is mutable
(or at least more easily mutable).  It is important to realize that much of
what can be considered ``structure'' here really is ``data''.  For example, a
quantity is not just a column name or some hard-coded location for certain
types of data.  It is data itself, with associated bounds, symbols, and
definitions.

\item The database SHOULD group flow data into 4 main categories:

    \begin{enumerate}

    \item study data (data that applies to an entire case or study),

    \item series data (data that applies to a series of profiles, like drag
    coefficients, etc.),

    \item station data (data that applies to a single profile, like the
    momentum thickness), and

    \item point data (data that applies to a single point in a flow, like the
    local unweighted averaged velocity).

    \end{enumerate}

\item The database SHOULD eliminate redundancy in the tables as much as
possible.  Each data point SHOULD have one and only one location.  The goal
here is to reduce or possibly eliminate any potential contradictions in the
data.  Database normalization practices help achieve this goal.

\item Similarly, the database MUST validate the data.  SQL \texttt{CHECK}
contraints and assertions in any Python code are only a start.

\item The database MUST include any supplemental data that may affect the flow
results.  This supplemental data includes information about the experimental or
numerical facilities, the instrumentation or methods used to measure or
calculate values, and any relevant literature sources or documentation.

\end{itemize}


\section{Database organization}

Unlike previous databases, this database does not store data as profiles or as
``header'' data.  Instead, it organizes data into four categories: study data,
series data, station data, and point data.  Each piece of data is stored as a
single record in one of those four categories, and this design allows for
greater flexibility and even redundancy at times, since the same variable can
be stored multiple times as different values, which could occur if different
measurement techniques or averaging systems were used.

Studies are the primary level of categorization.  Each study is a series of
observations by a research group, like a paper or a set of related papers.
Studies contain series, series contain stations, and stations contain points.
Series refer to a particular flow field in its entirety, like the entire flow
field around an object, or an entire set of boundary layer profiles.  Stations
refer to a single profile in space at specified streamwise and spanwise
coordinates.  And finally, points refer to particular data points in space with
all three coordinates specified.

Different quantities only exist within different categories of data.  For
example, consider the flow around an object.  The drag coefficient is a series
quantity, the boundary layer thickness is a station quantity, and the
streamwise velocity is a point quantity.  Some quantities only exist at walls,
like the skin friction coefficient, but since there could be multiple walls (as
in internal flows) these quantities are stored as point data, though in many
cases they can be identified uniquely by specifying the station.

To locate records in the database, each category of data is assigned a unique
identifier of the following form: flow class (1 letter), year (4 digits), study
number (3 digits), series number (3 digits), station number (3 digits), and
point number (4 digits).  Only the first three are needed to identify a study.
For example, \texttt{D-1914-001} is a study identifier.  The dashes are used
for readability but not stored in the database.
\texttt{D-1911-001-005-001-0013} is a point identifier.  Using these kind of
identifiers, it is possible to uniquely find data in the database.  Note that
the identifiers are systematic: the point identifier specifies the study,
series, and station it belongs to.

The flow classes are described in an appendix.

